{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport moment from \"moment\";\nimport Link from \"next/link\";\nimport MenuService from \"~/packages/Post/services/MenuService\";\nimport PostService from \"~/packages/Post/services/PostService\";\nimport HotelService from \"~/packages/TravelgoOne/services/HotelService\";\nimport LastminuteService from \"~/packages/TravelgoOne/services/LastminuteService\";\nimport Layout from \"~/components/Layouts/MainLayout/MainLayout\";\nimport BookingSearchBox from \"~/components/Partials/BookingSearchBox\";\nimport BookingForm from \"~/components/Partials/BookingForm\";\nimport PriceTable from '~/components/Partials/PriceTable';\n\nvar LastminutePage = function LastminutePage(props) {\n  if (!props.page || props.page.length <= 0) {\n    return __jsx(Layout, {\n      settings: {\n        menu: props.menu\n      }\n    }, __jsx(\"div\", null, \"Data not found\"));\n  }\n\n  var lastminute = props.page;\n  var hotel = lastminute.hotel;\n  var dateFrom = moment(lastminute.date_from, \"YYYY-MM-DD\");\n  var dateTo = moment(lastminute.date_to, \"YYYY-MM-DD\");\n  var stars = [];\n\n  for (var i = 1; i <= parseInt(hotel.stars); i++) {\n    stars.push(__jsx(\"i\", {\n      key: i,\n      className: \"ico ico-star\"\n    }));\n  }\n\n  var priceList = {};\n\n  for (var _i in lastminute.prices) {\n    priceList[lastminute.prices[_i].treatment] = {\n      n1: null,\n      n2: null,\n      n3: null,\n      n4: null,\n      n5: null,\n      n6: null,\n      n7: null,\n      n8: null,\n      n9: null,\n      n10: null,\n      n11: null,\n      n12: null,\n      n13: null,\n      n14: null\n    };\n  }\n\n  for (var _i2 in lastminute.prices) {\n    priceList[lastminute.prices[_i2].treatment]['n' + lastminute.prices[_i2].nights] = lastminute.prices[_i2];\n  }\n\n  return __jsx(Layout, {\n    settings: {\n      template: \"lastminute-page\",\n      menu: props.menu\n    },\n    meta: {\n      title: props.page.meta_title.it,\n      description: props.page.meta_description.it,\n      image: props.page.media && props.page.media.gallery && props.page.media.gallery[0] ? props.page.media.gallery[0].url : null // image: (props.page.media && props.page.media.thumbnails && props.page.media.thumbnails[0]) ? props.page.media.thumbnails[0].url : null\n\n    }\n  }, __jsx(BookingSearchBox, null), __jsx(\"section\", {\n    className: \"single-hotel-section\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"figure\", {\n    className: \"img-bgas\"\n  }, __jsx(\"img\", {\n    src: hotel.media.gallery[0].url,\n    alt: hotel.media.gallery[0].name\n  })), __jsx(\"div\", {\n    className: \"topline\"\n  }, __jsx(\"div\", {\n    className: \"title mr-auto\"\n  }, __jsx(\"h1\", null, hotel.name), __jsx(\"div\", {\n    className: \"stars\"\n  }, stars)), __jsx(\"div\", {\n    className: \"single-hotel-call ml-auto\"\n  }, \"chiama!\\xA0\", __jsx(\"span\", {\n    className: \"bold\"\n  }, process.env.contacts.phone.label))))), __jsx(\"section\", {\n    className: \"single-hotel-section\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"hotel-booking-box\"\n  }, __jsx(\"div\", {\n    className: \"box1\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, priceList && Object.entries(priceList).map(function (_ref, index) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        treatment = _ref2[0],\n        prices = _ref2[1];\n\n    return __jsx(\"div\", {\n      className: \"prices-box\",\n      key: index\n    }, __jsx(PriceTable, {\n      key: index,\n      index: index,\n      treatment: treatment,\n      prices: prices,\n      hotel: hotel,\n      lastminute: lastminute\n    }));\n  })), __jsx(\"div\", {\n    className: \"col-lg-4 offset-lg-2\"\n  }, __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    className: \"row mb-5\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, \"Offerta n. \", lastminute.id), __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, \"dal \", dateFrom.format(\"DD/MM/YYYY\"), __jsx(\"br\", null), \"al \", dateTo.format(\"DD/MM/YYYY\"))), \"per ulteriori informazioni contattaci a\", __jsx(\"br\", null), __jsx(\"span\", {\n    className: \"bold\"\n  }, process.env.contacts.email.label))))), __jsx(BookingForm, null)))), __jsx(\"section\", {\n    className: \"section-main single-hotel-section\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-3\"\n  }, __jsx(\"div\", {\n    className: \"content-box content-box-1\"\n  }, __jsx(\"div\", {\n    className: \"titoletto\"\n  }, \"posizione\"), __jsx(\"div\", {\n    className: \"description\"\n  }, hotel.details.address, __jsx(\"br\", null), hotel.details.zip_code, \" \", hotel.details.city, \" (\", hotel.details.state, \")\"), __jsx(\"div\", {\n    className: \"titoletto\"\n  }, \"distanze\"), __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: hotel.description_near.it\n    }\n  })), __jsx(\"ul\", {\n    className: \"hotel-service-list\"\n  }, hotel.incServices && hotel.incServices.length > 0 && hotel.incServices.map(function (obj, index) {\n    return __jsx(\"li\", {\n      key: index\n    }, __jsx(\"span\", null, __jsx(\"i\", {\n      className: \"ico ico-childrens\"\n    }), obj.name));\n  })))), __jsx(\"div\", {\n    className: \"col-lg-4\"\n  }, __jsx(\"div\", {\n    className: \"content-box content-box-2\"\n  }, __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: hotel.description_short.it\n    }\n  })))), __jsx(\"div\", {\n    className: \"col-lg-5\"\n  }, __jsx(\"div\", {\n    className: \"content-box content-box-3\"\n  }, __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: hotel.description_short.it\n    }\n  }))))))));\n};\n\nLastminutePage.getInitialProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {\n    var menu, page, hotels, menuService, lastminuteService;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            menu = null;\n            page = null;\n            hotels = [];\n            _context.prev = 3;\n            menuService = new MenuService();\n            _context.next = 7;\n            return menuService.get(1);\n\n          case 7:\n            menu = _context.sent;\n            lastminuteService = new LastminuteService();\n            _context.next = 11;\n            return lastminuteService.getBySlug(params.query.lastminute);\n\n          case 11:\n            page = _context.sent;\n            _context.next = 16;\n            break;\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](3);\n\n          case 16:\n            return _context.abrupt(\"return\", {\n              menu: menu,\n              page: page\n            });\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[3, 14]]);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nexport default LastminutePage;","map":null,"metadata":{},"sourceType":"module"}