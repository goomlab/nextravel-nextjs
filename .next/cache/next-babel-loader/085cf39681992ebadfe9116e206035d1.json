{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport moment from \"moment\";\nimport Link from \"next/link\";\nimport Head from 'next/Head';\nimport { HotelSchema, makeHotelSchema } from \"~/components/JsonLdSchema\";\nimport SwiperCore, { Swiper, Navigation, Pagination, Scrollbar, A11y } from 'swiper';\nSwiperCore.use([Navigation, Pagination, Scrollbar, A11y]);\nimport BaseService from \"~/packages/BaseService\";\nimport MenuService from \"~/packages/Post/services/MenuService\";\nimport PostService from \"~/packages/Post/services/PostService\";\nimport HotelService from \"~/packages/TravelgoOne/services/HotelService\";\nimport RateplanPeriodService from \"~/packages/TravelgoOne/services/RateplanPeriodService\";\nimport Layout from \"~/components/Layouts/MainLayout/MainLayout\";\nimport BookingSearchBox from \"~/components/Partials/BookingSearchBox\";\nimport BookingForm from \"~/components/Partials/BookingForm\";\nimport HotelAgeRangesTable from '~/components/Partials/HotelAgeRangesTable';\nimport HotelExtraServicesTable from '~/components/Partials/HotelExtraServicesTable';\nimport PriceTable from '~/components/Partials/PriceTable';\nimport PriceTableWrap from '~/components/Partials/PriceTableWrap';\nimport PriceTableWrap2 from '~/components/Partials/PriceTableWrap2';\nimport JsonLdSchema from \"../../../../components/JsonLdSchema\";\n\nvar BookingPage = function BookingPage(props) {\n  if (!props.hotel) {\n    return __jsx(Layout, {\n      settings: {\n        menu: props.menu\n      }\n    }, __jsx(\"div\", null, \"Data not found\"));\n  }\n\n  var period = props.period;\n  var hotel = props.hotel;\n  var swiperHotelThumbnail = React.useRef(null);\n  var dateFrom = moment(period.date_from, \"YYYY-MM-DD\");\n  var dateTo = moment(period.date_to, \"YYYY-MM-DD\");\n  var stars = [];\n\n  for (var i = 1; i <= parseInt(hotel.stars); i++) {\n    stars.push(__jsx(\"i\", {\n      key: i,\n      className: \"ico ico-star\"\n    }));\n  } // let priceList = {};\n  // for (const [key, treatmentObj] of Object.entries(props.period.viewPrices)) {\n  //   priceList[key] = {\n  //     n1: (treatmentObj.n1) ? treatmentObj.n1 : null,\n  //     n2: (treatmentObj.n2) ? treatmentObj.n2 : null,\n  //     n3: (treatmentObj.n3) ? treatmentObj.n3 : null,\n  //     n4: (treatmentObj.n4) ? treatmentObj.n4 : null,\n  //     n5: (treatmentObj.n5) ? treatmentObj.n5 : null,\n  //     n6: (treatmentObj.n6) ? treatmentObj.n6 : null,\n  //     n7: (treatmentObj.n7) ? treatmentObj.n7 : null,\n  //   };\n  // }\n  // let priceList = {}\n  // for (const [roomTypeName, roomTypeContent] of Object.entries(period.viewPeriodPrices)){\n  //   priceList[roomTypeName] = {};\n  //   if( roomTypeContent.prices ){\n  //     for (const [key, treatmentObj] of Object.entries(roomTypeContent.prices)) {\n  //       priceList[roomTypeName][key] = {\n  //         n1: (treatmentObj.n1) ? treatmentObj.n1 : null,\n  //         n2: (treatmentObj.n2) ? treatmentObj.n2 : null,\n  //         n3: (treatmentObj.n3) ? treatmentObj.n3 : null,\n  //         n4: (treatmentObj.n4) ? treatmentObj.n4 : null,\n  //         n5: (treatmentObj.n5) ? treatmentObj.n5 : null,\n  //         n6: (treatmentObj.n6) ? treatmentObj.n6 : null,\n  //         n7: (treatmentObj.n7) ? treatmentObj.n7 : null,\n  //       };\n  //     }\n  //   }\n  // }\n\n\n  React.useEffect(function () {\n    swiperHotelThumbnail.current = new Swiper(\"#swiperHotelThumbnail\", {\n      grubCursor: false,\n      simulateTouch: false,\n      direction: 'horizontal',\n      //speed: 600,\n      slidesPerView: 1,\n      spaceBetween: 0,\n      navigation: {\n        nextEl: \"#swiperHotelThumbnail-button-next\",\n        prevEl: \"#swiperHotelThumbnail-button-prev\"\n      }\n    });\n  }, []);\n  return __jsx(Layout, {\n    settings: {\n      template: \"booking-page\",\n      menu: props.menu\n    },\n    meta: {\n      title: \"Booking \".concat(props.hotel.meta_title.it),\n      description: \"Booking\",\n      canonical: \"\".concat(process.env.meta.url, \"/accommodations/\").concat(props.hotel.slug.it),\n      url: \"\".concat(process.env.meta.url, \"/accommodations/\").concat(props.hotel.slug.it, \"/booking\"),\n      image: props.hotel.media && props.hotel.media.gallery && props.hotel.media.gallery[0] ? props.hotel.media.gallery[0].url : null // jsonlds:[\n      //   <HotelSchema hotel={props.hotel} />\n      // ]\n\n    }\n  }, __jsx(Head, null, __jsx(\"script\", {\n    key: \"jobJSON-\".concat(hotel.id),\n    type: \"application/ld+json\",\n    dangerouslySetInnerHTML: {\n      __html: JSON.stringify(makeHotelSchema(hotel))\n    }\n  })), __jsx(BookingSearchBox, null), __jsx(\"section\", {\n    className: \"single-hotel-section\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    id: \"swiperHotelThumbnail\",\n    className: \"swiper-container swiperHotelThumbnail\"\n  }, __jsx(\"div\", {\n    className: \"swiper-wrapper\"\n  }, hotel.media && hotel.media.gallery.map(function (img, index) {\n    return __jsx(\"div\", {\n      className: \"swiper-slide\",\n      key: index\n    }, __jsx(\"figure\", {\n      className: \"img-bgas\"\n    }, __jsx(\"img\", {\n      src: img.url,\n      alt: img.name\n    })));\n  }), (!hotel.media || !hotel.media.gallery) && __jsx(\"div\", {\n    className: \"swiper-slide\"\n  }, __jsx(\"figure\", {\n    \"class\": \"img-bgas\"\n  }, __jsx(\"img\", {\n    src: \"default\",\n    alt: \"\"\n  })))), __jsx(\"div\", {\n    id: \"swiperHotelThumbnail-button-prev\",\n    className: \"swiper-button-prev\"\n  }), __jsx(\"div\", {\n    id: \"swiperHotelThumbnail-button-next\",\n    className: \"swiper-button-next\"\n  })), __jsx(\"div\", {\n    className: \"topline\"\n  }, __jsx(\"div\", {\n    className: \"title mr-auto\"\n  }, __jsx(\"h1\", null, hotel.name), __jsx(\"div\", {\n    className: \"stars\"\n  }, stars)), __jsx(\"div\", {\n    className: \"single-hotel-call ml-auto\"\n  }, \"chiama!\\xA0\", __jsx(\"span\", {\n    className: \"bold\"\n  }, process.env.contacts.phone.label))))), __jsx(\"section\", {\n    className: \"single-hotel-section\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"hotel-booking-box\"\n  }, __jsx(\"div\", {\n    className: \"box1\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, __jsx(PriceTableWrap2, props), period.hotelAgeRanges && period.hotelAgeRanges.length > 0 && __jsx(HotelAgeRangesTable, {\n    hotelAgeRanges: period.hotelAgeRanges\n  }) // <React.Fragment>\n  //   <span>Supplementi e Riduzioni per età</span>\n  //   <table className=\"prices-table\">\n  //     <tbody>\n  //       {period.hotelAgeRanges.map( (obj, index) => \n  //         <tr key={index}>\n  //           <td className=\"service-name\">\n  //             {obj.age_min} - {obj.age_max}\n  //           </td>\n  //           <td className=\"service-price\">\n  //             <span className=\"no-smartphone\">{(obj.price_type == 'fixed') ? '€ ' : '+ '}</span>\n  //             {obj.price},-\n  //             {(obj.price_type == 'percent') ? ' %' : ''}\n  //           </td>\n  //         </tr>\n  //       )}\n  //     </tbody>\n  //   </table>\n  // </React.Fragment>\n  , hotel.extraServices && hotel.extraServices.length > 0 && __jsx(HotelExtraServicesTable, {\n    extraServices: hotel.extraServices\n  }) // <React.Fragment>\n  //   <span>Servizi aggiuntivi</span>\n  //   <table class=\"prices-table\">\n  //     <tbody>\n  //       {hotel.extraServices.map( (obj, index) => \n  //         <tr key={index}>\n  //           <td className=\"service-name\">\n  //             {obj.name}\n  //           </td>\n  //           <td className=\"service-price\">\n  //             <span className=\"no-smartphone\">{(obj.pivot.price_type == 'fixed') ? '€ ' : '+ '}</span>\n  //             {obj.pivot.price},-\n  //             {(obj.pivot.price_type == 'percent') ? ' %' : ''}\n  //           </td>\n  //         </tr>\n  //       )}\n  //     </tbody>\n  //   </table>\n  // </React.Fragment>\n  ), __jsx(\"div\", {\n    className: \"col-lg-4 offset-lg-2\"\n  }, __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    className: \"row mb-5\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, \"Offerta n. \", period.id), __jsx(\"div\", {\n    className: \"col-lg-6\"\n  }, \"dal \", dateFrom.format(\"DD/MM/YYYY\"), __jsx(\"br\", null), \"al \", dateTo.format(\"DD/MM/YYYY\"))), \"per ulteriori informazioni contattaci a\", __jsx(\"br\", null), __jsx(\"span\", {\n    className: \"bold\"\n  }, process.env.contacts.email.label))))), __jsx(BookingForm, {\n    rateplan: props.period.rateplan || null,\n    hotel: props.period.rateplan.hotel || null,\n    query: props.query,\n    period: props.period\n  })))), __jsx(\"section\", {\n    className: \"section-main single-hotel-section\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-3\"\n  }, __jsx(\"div\", {\n    className: \"content-box content-box-1\"\n  }, __jsx(\"div\", {\n    className: \"titoletto\"\n  }, \"posizione\"), __jsx(\"div\", {\n    className: \"description\"\n  }, hotel.details.address, __jsx(\"br\", null), hotel.details.zip_code, \" \", hotel.details.city, \" (\", hotel.details.state, \")\"), __jsx(\"div\", {\n    className: \"titoletto\"\n  }, \"distanze\"), __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: hotel.description_near.it\n    }\n  })), __jsx(\"ul\", {\n    className: \"hotel-service-list\"\n  }, hotel.incServices && hotel.incServices.length > 0 && hotel.incServices.map(function (obj, index) {\n    return __jsx(\"li\", {\n      key: index\n    }, __jsx(\"span\", null, obj.name));\n  })))), __jsx(\"div\", {\n    className: \"col-lg-4\"\n  }, __jsx(\"div\", {\n    className: \"content-box content-box-2\"\n  }, __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: hotel.description_short.it\n    }\n  })))), __jsx(\"div\", {\n    className: \"col-lg-5\"\n  }, __jsx(\"div\", {\n    className: \"content-box content-box-3\"\n  }, __jsx(\"div\", {\n    className: \"description\"\n  }, __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: hotel.description_short.it\n    }\n  }))))))));\n};\n\nBookingPage.getInitialProps = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {\n    var locs, hotelCategories, menu, page, hotel, period, query, baseService, init, menuService, rateplanPeriodService;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            locs = [];\n            hotelCategories = [];\n            menu = null;\n            page = null;\n            hotel = null;\n            period = null;\n            query = {\n              checkin: params.query.checkin || null,\n              checkout: params.query.checkout || null,\n              treatment: params.query.treatment || null,\n              room_type_id: params.query.room_type_id || null,\n              nights: params.query.nights || null\n            };\n            _context.prev = 7;\n            baseService = new BaseService();\n            _context.next = 11;\n            return baseService.initApp();\n\n          case 11:\n            init = _context.sent;\n            locs = init.locs || [];\n            hotelCategories = init.hotelCategories || [];\n            menuService = new MenuService();\n            _context.next = 17;\n            return menuService.get(1);\n\n          case 17:\n            menu = _context.sent;\n            rateplanPeriodService = new RateplanPeriodService();\n            _context.next = 21;\n            return rateplanPeriodService.get(params.query.id);\n\n          case 21:\n            period = _context.sent;\n\n            if (period && period.rateplan && period.rateplan.hotel) {\n              hotel = period.rateplan.hotel;\n            }\n\n            _context.next = 27;\n            break;\n\n          case 25:\n            _context.prev = 25;\n            _context.t0 = _context[\"catch\"](7);\n\n          case 27:\n            return _context.abrupt(\"return\", {\n              query: query,\n              locs: locs,\n              hotelCategories: hotelCategories,\n              menu: menu,\n              page: page,\n              hotel: hotel,\n              period: period\n            });\n\n          case 28:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[7, 25]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default BookingPage;","map":null,"metadata":{},"sourceType":"module"}