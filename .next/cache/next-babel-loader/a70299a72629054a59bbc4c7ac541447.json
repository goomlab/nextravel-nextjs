{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport moment from 'moment';\nimport PostService from \"~/packages/Post/services/PostService\";\n\nvar createSitemap = function createSitemap(models) {\n  return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n    <urlset xmlns=\\\"http://www.sitemaps.org/schemas/sitemap/0.9\\\">\\n        \".concat(models.map(function (model, index) {\n    var updatedAt = moment(model.updated_at, \"DD/MM/YYYY hh:mm:ss\").toISOString(); // 12/03/2021 17:05:06  -->  2021-02-17T11:39:04+00:00\n\n    return \"\\n                    <url>\\n                        <loc>\".concat(\"\".concat(process.env.app_url, \"/\").concat(model.slug.it), \"</loc>\\n                        <lastmod>\", updatedAt, \"</lastmod>\\n                    </url>\\n                \");\n  }).join(''), \"\\n    </urlset>\\n    \");\n};\n\nvar Sitemap = /*#__PURE__*/function (_React$Component) {\n  _inherits(Sitemap, _React$Component);\n\n  var _super = _createSuper(Sitemap);\n\n  function Sitemap() {\n    _classCallCheck(this, Sitemap);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Sitemap, null, [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n        var res, service, models;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                res = _ref.res;\n                service = new PostService();\n                _context.next = 4;\n                return service.all({\n                  status: {\n                    key: 'status',\n                    compare: '=',\n                    value: 1\n                  }\n                });\n\n              case 4:\n                _context.t0 = _context.sent;\n\n                if (_context.t0) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.t0 = [];\n\n              case 7:\n                models = _context.t0;\n                // const request = await fetch(EXTERNAL_DATA_URL);\n                // const posts = await request.json();\n                res.setHeader('Content-Type', 'text/xml');\n                res.write(createSitemap(models));\n                res.end();\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return Sitemap;\n}(React.Component);\n\nexport default Sitemap;","map":{"version":3,"sources":["/Users/giuseppe/Workspace/Di Costanzo Marco/nextravel.it/www/nextravel-nextjs/pages/sitemap/pages.js"],"names":["React","moment","PostService","createSitemap","models","map","model","index","updatedAt","updated_at","toISOString","process","env","app_url","slug","it","join","Sitemap","res","service","all","status","key","compare","value","setHeader","write","end","Component"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,OAAOC,WAAP,MAAwB,sCAAxB;;AAEA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,MAAD;AAAA,2IAEZA,MAAM,CAACC,GAAP,CAAW,UAACC,KAAD,EAAQC,KAAR,EAAkB;AAC3B,QAAIC,SAAS,GAAGP,MAAM,CAACK,KAAK,CAACG,UAAP,EAAmB,qBAAnB,CAAN,CAAgDC,WAAhD,EAAhB,CAD2B,CACoD;;AAC/E,yFAEsBC,OAAO,CAACC,GAAR,CAAYC,OAFlC,cAE6CP,KAAK,CAACQ,IAAN,CAAWC,EAFxD,gDAGuBP,SAHvB;AAMD,GARD,EASCQ,IATD,CASM,EATN,CAFY;AAAA,CAAtB;;IAeMC,O;;;;;;;;;;;;;;;;;;;;AAC2BC,gBAAAA,G,QAAAA,G;AACzBC,gBAAAA,O,GAAU,IAAIjB,WAAJ,E;;uBACKiB,OAAO,CAACC,GAAR,CAAY;AAC7BC,kBAAAA,MAAM,EAAE;AAACC,oBAAAA,GAAG,EAAE,QAAN;AAAgBC,oBAAAA,OAAO,EAAE,GAAzB;AAA8BC,oBAAAA,KAAK,EAAE;AAArC;AADqB,iBAAZ,C;;;;;;;;;;8BAEb,E;;;AAFFpB,gBAAAA,M;AAIJ;AACA;AAEAc,gBAAAA,GAAG,CAACO,SAAJ,CAAc,cAAd,EAA8B,UAA9B;AACAP,gBAAAA,GAAG,CAACQ,KAAJ,CAAUvB,aAAa,CAACC,MAAD,CAAvB;AACAc,gBAAAA,GAAG,CAACS,GAAJ;;;;;;;;;;;;;;;;;;;EAZkB3B,KAAK,CAAC4B,S;;AAgB5B,eAAeX,OAAf","sourcesContent":["import React from 'react';\nimport moment from 'moment';\n\nimport PostService from \"~/packages/Post/services/PostService\";\n\nconst createSitemap = (models) => `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n        ${models.map((model, index) => {\n            let updatedAt = moment(model.updated_at, \"DD/MM/YYYY hh:mm:ss\").toISOString(); // 12/03/2021 17:05:06  -->  2021-02-17T11:39:04+00:00\n            return `\n                    <url>\n                        <loc>${`${process.env.app_url}/${model.slug.it}`}</loc>\n                        <lastmod>${updatedAt}</lastmod>\n                    </url>\n                `;\n          })\n          .join('')}\n    </urlset>\n    `;\n\nclass Sitemap extends React.Component {\n  static async getInitialProps({ res }) {\n    let service = new PostService();\n    let models = await service.all({\n      status: {key: 'status', compare: '=', value: 1}\n    }) || [];\n\n    // const request = await fetch(EXTERNAL_DATA_URL);\n    // const posts = await request.json();\n\n    res.setHeader('Content-Type', 'text/xml');\n    res.write(createSitemap(models));\n    res.end();\n  }\n}\n\nexport default Sitemap;"]},"metadata":{},"sourceType":"module"}